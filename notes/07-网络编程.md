## 网络通信协议 TCP/IP :

协议理解为网络通信间的各方遵守的协定,商定,约定等.

### TCP/IP协议(族)

TCP/IP 协议不是两个协议而是协议的总称,在之中包含了很多小的协议.



规范两台电脑之间传数据是怎么传.

![TCP／IP协议族中各协议之间的关系.jpg](https://i.loli.net/2019/02/22/5c6f950876c16.jpg)

TCP/IP 协议层次划分 链路层 -> 网络层->传输层->应用层



按照 7层分:物理层->数据链路层->网络层->传输层->会话层->表示层->应用层.

## 端口

端口是标记进程唯一的方式

### 端口号

端口号为整数,范围从0到65535

```
80端口分配给HTTP服务
21端口分配给FTP服务
```



### 知名端口

就是知名网站使用的端口,是不会改变的.比如百度等等



### 动态端口

动态端口的范围从1024到65535 

动态端口为当程序需要某个服务时动态的分配相应的端口,程序结束时就将端口释放.也就是说不固定分配给某个特定的服务.

查看端口 : netstat -an 命令



## ip地址

标记一台电脑

IP地址分类

ABCDE类

A:网络号7 位 主机号24位

B:网络号 14位 ,主机号 16位

C:110 +网络号21位 ,主机号8位

D:1110+

E:11110 +

主机号是可变的,网络好在一个局域网是不变的.,主机号的全0和1 不能使用

例如:

192.168.119.255 为广播地址,

192.168.119.0 为网络号.

DE两类在ipv6出来后就摈弃了.

现在郭磊主要用的还是IPV4 



A:1.0.0.1 - 126.255.255.254可以容纳 1677214台主机

B:128.1.0.1 - 191.255.255.254 可以容纳 65535台主机

c:192.0.1.1 - 223.255.255.254 可以容纳254台主机

#### 注意

ip :127.0.0.1-  127.255.255.255用于回路测试

如127.0.0.1 可以代表本机IP地址,用http://127.0.0.1 就可以测试本机中的配置

## 私有 IP地址

私有IP地址是估计规定有一部分IP地址用与局域网使用.也就是我们所说的私有IP,不在公网中使用,他们的范围是:

10.0.0.0 -10.255.255.255

172.16.0.0 - 172.31.255.255

192.168.0.0 - 192.168.255.255



## socket(套接字) 

完成多个电脑之间通信的方式

套接字使用:

import socket *

s = socket(AF_INET,SOCKET_XXX)

s.send("内容",("地址",端口))



## UDP

用户数据报协议.是一个无连接面向数据报的运输层协议,是一个不可靠的传输协议,在传输过程中,最大传输数据包最大为64KB ,由于UDP为无连接传输,在每次传输是需要包括数据+端口号+源地址信息+目的地址,并且可以广播发送,到达目的的数据不能保证正确以及时间.



注意:在同一台设备端口不允许相同,端口用来区分一个进程因此不允许相同.

UDP 端口绑定

import socket *

udpSocket = socket(AF_INET,SOCK_DGRAM)



bindAddr = ("",7788) #i地址可以先不填,自动获取自己端脑的ip

udpSocket.bind(bindAddr)



单工 只能收

半双工(对讲机类,不弄同时)

全双工(可以同时发生)

发送:
sendto("",("",xxx))

接收:

recvfrom(1024)#参数为接收的字节数



对于py3来说发送到数据需要编码才能发送 使用 str.encode("utf-8")

接收方要使用 str.decode("utf-8")

如果不输入中文,就不需要解码都能显示.



### Echo服务器

用来接收到数据后给发送端回一个消息



模拟扣扣聊天

```python
from threading import Thread
from socket import *
#第一步发消息
def sendMwssage():
    while 1:
        message = input(">> ")
        udpSocket.sendto(message.encode("utf-8"),("192.168.1.104",8080))
#接收消息
def recvMessage():
    udpSocket.bind(("",6789))
    while 1:
        recv = udpSocket.recvfrom(1024)
        print("\r%s"%"<< "+recv[0].decode("utf-8"),end="\n>> ")

def main():
    global ip,port,udpSocket
    udpSocket = socket(AF_INET,SOCK_DGRAM)
    tx = Thread(target=sendMwssage)
    rx = Thread(target=recvMessage)
    ip = input("输入对方ip:")
    port = int(input("输入对方port:"))
    
    tx.start()
    rx.start()

    tx.join()
    rx.join()

if __name__=="__main__":
    main()

```



 print("\r%s"%"<< "+recv[0].decode("utf-8"),end="\n>> ") 这句话中 "\r"作用添加的字符来替换本行前面的字符,等字符数目替换,

```python
>> print("sas\rss\r")
sss
>>> print("adg\rss\r")
ssg
>>> print("adg\rss")
ssg
>>> print("adg\rss")
```

